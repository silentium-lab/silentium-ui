{"version":3,"file":"silentium-ui.min.mjs","sources":["../src/ClassName.ts","../src/Clicked.ts","../src/html.ts","../src/Id.ts","../src/Button.ts","../src/Checkbox.ts","../src/KeyPressed.ts","../src/Input.ts","../src/Link.ts","../src/LinkExternal.ts","../src/Mount.ts","../src/MountPoint.ts","../src/Select.ts","../src/Textarea.ts"],"sourcesContent":["import { Applied, MessageType } from \"silentium\";\n\n/**\n * CSS class name representation\n */\nexport function ClassName(s: MessageType<string>) {\n  return Applied<string, string>(s, (s) => \".\" + s);\n}\n","import { Message, MessageType } from \"silentium\";\n\n/**\n * DOM element click even\n */\nexport function Clicked($class: MessageType<string>) {\n  return Message<Event>((resolve) => {\n    let className = \".no-class-of-such-name\";\n    const handler = (event: PointerEvent) => {\n      const target = event.target as HTMLElement;\n      if (!target) {\n        return;\n      }\n      if (target.classList.contains(className)) {\n        resolve(event);\n      }\n      const closestElement = target.closest(className);\n      if (closestElement) {\n        resolve(event);\n      }\n    };\n    $class.then((newClassName) => {\n      className = newClassName;\n      (handler as any).className = newClassName;\n      document.body.addEventListener(\"click\", handler);\n    });\n\n    return () => {\n      document.body.removeEventListener(\"click\", handler);\n    };\n  });\n}\n","/**\n * Render html string\n */\nexport function html(strings: any, ...values: any[]) {\n  let result = \"\";\n  for (let i = 0; i < strings.length; i++) {\n    result += strings[i];\n    if (i < values.length) {\n      result += values[i];\n    }\n  }\n  return result;\n}\n","import { All, Applied, MessageType, Of } from \"silentium\";\nimport { v4 } from \"uuid\";\n\n/**\n * Representation of a unique id\n */\nexport function Id(baseSrc: MessageType<string> = Of(\"id\")) {\n  return Applied(All(baseSrc, Of(v4())), (v) => v.join(\"_\"));\n}\n","import {\n  Actual,\n  Connected,\n  MaybeMessage,\n  Of,\n  Shared,\n  SourceType,\n} from \"silentium\";\nimport { Template } from \"silentium-components\";\nimport { ClassName } from \"./ClassName\";\nimport { Clicked } from \"./Clicked\";\nimport { html } from \"./html\";\nimport { Id } from \"./Id\";\n\nexport function Button(\n  $label: MaybeMessage<string>,\n  $class: MaybeMessage<string>,\n  click: SourceType,\n  $attributes: MaybeMessage<string> = Of(\"\"),\n  value?: unknown,\n) {\n  const $id = Shared(Id());\n  const clicked = Clicked(ClassName($id));\n  clicked.then((e) => {\n    e.preventDefault();\n    click.use(value ?? e);\n  });\n  return Connected<string>(\n    Template(\n      (t) =>\n        html`<button\n          ${t.escaped(Actual($attributes))}\n          class=\"${t.escaped($id)} ${t.escaped(Actual($class))} cursor-pointer\"\n        >\n          ${t.escaped(Actual($label))}\n        </button>`,\n    ),\n    clicked,\n  );\n}\n","import {\n  Actual,\n  All,\n  FromEvent,\n  MaybeMessage,\n  Message,\n  MessageSourceType,\n  Shared,\n} from \"silentium\";\nimport { Template } from \"silentium-components\";\nimport { Element } from \"silentium-web-api\";\nimport { ClassName } from \"./ClassName\";\nimport { html } from \"./html\";\nimport { Id } from \"./Id\";\n\n/**\n * Component what represent\n * checkbox\n */\nexport function Checkbox(\n  label: MaybeMessage<string>,\n  $value: MessageSourceType<boolean>,\n) {\n  const $label = Actual(label);\n  return Template(\n    (t) => html`\n      <label>\n        <input class=\"${t.escaped(CheckedId($value))} \" type=\"checkbox\" />\n        ${t.escaped($label)}\n      </label>\n    `,\n  );\n}\n\nexport function CheckedId($value: MessageSourceType<boolean>) {\n  return Message<string>((resolve, reject) => {\n    const $id = Shared(Id());\n    $id.then(resolve);\n\n    const $el = Shared(Element<HTMLInputElement>(ClassName($id)));\n\n    All($el, $value).then(([el, value]) => {\n      if (el) {\n        el.checked = value;\n      }\n    });\n\n    const event = FromEvent<Event>(\n      $el,\n      \"change\",\n      \"addEventListener\",\n      \"removeEventListener\",\n    )\n      .catch(reject)\n      .then((e) => {\n        $value.use((e.target as HTMLInputElement).checked);\n      });\n\n    return () => {\n      event.destroy();\n    };\n  });\n}\n","import { FromEvent, MessageType, Of } from \"silentium\";\n\n/**\n * DOM element keypress even\n */\nexport function KeyPressed<T extends Event>($el: MessageType<HTMLElement>) {\n  return FromEvent<T>(\n    $el,\n    Of(\"keyup\"),\n    Of(\"addEventListener\"),\n    Of(\"removeEventListener\"),\n  );\n}\n","import { All, Message, MessageSourceType, Shared } from \"silentium\";\nimport { Task, Template } from \"silentium-components\";\nimport { Element } from \"silentium-web-api\";\nimport { html } from \"./html\";\nimport { Id } from \"./Id\";\nimport { ClassName } from \"./ClassName\";\nimport { KeyPressed } from \"./KeyPressed\";\n\nexport function Input($value: MessageSourceType<string>) {\n  return Template(\n    (t) => html`\n      <input\n        name=\"title\"\n        class=\"${t.escaped(\n          InputId($value),\n        )} border-1 border-gray-300 bg-white p-2 rounded-sm w-full\"\n      />\n    `,\n  );\n}\n\nexport function InputId($value: MessageSourceType<string>) {\n  return Message<string>((transport) => {\n    const $id = Shared(Id());\n    $id.then(transport);\n\n    const $el = Shared(Element<HTMLInputElement>(ClassName($id)));\n\n    All($el, $value).then(([el, value]) => {\n      if (el) {\n        el.value = typeof value === \"string\" ? value : String(value);\n      }\n    });\n\n    const pressed = KeyPressed<InputEvent>($el);\n    Task(pressed, 150).then((e: InputEvent) => {\n      $value.use((e.target as HTMLInputElement).value);\n    });\n  });\n}\n","import { MessageType, Of, Primitive, Shared, Context } from \"silentium\";\nimport { Template } from \"silentium-components\";\nimport { ClassName } from \"./ClassName\";\nimport { Clicked } from \"./Clicked\";\nimport { html } from \"./html\";\nimport { Id } from \"./Id\";\n\nexport function Link(\n  $linkUrl: MessageType<string>,\n  $text: MessageType<string>,\n  $class: MessageType<string> = Of(\"\"),\n) {\n  const $url = Context<string>(\"url\");\n  const $id = Shared(Id());\n  const url = Primitive($linkUrl);\n\n  const clicked = Clicked(ClassName($id));\n  clicked.then((e: Event) => {\n    e.preventDefault();\n    $url.use(url.primitive() as string);\n  });\n\n  return Template(\n    (t) =>\n      html`<a\n        href=\"${t.escaped($linkUrl)}\"\n        class=\"${t.escaped($id)} ${t.escaped($class)}\"\n      >\n        ${t.raw($text)}\n      </a>`,\n  );\n}\n","import { MessageType, Of } from \"silentium\";\nimport { Template } from \"silentium-components\";\nimport { html } from \"./html\";\n\nexport function LinkExternal(\n  $url: MessageType<string>,\n  $text: MessageType<string>,\n  $class: MessageType<string> = Of(\"\"),\n) {\n  return Template(\n    (t) =>\n      html`<a\n        href=\"${t.escaped($url)}\"\n        target=\"_blank\"\n        class=\"${t.escaped($class)}\"\n      >\n        ${t.escaped($text)}\n      </a>`,\n  );\n}\n","import {\n  Any,\n  Applied,\n  DestroyContainer,\n  Message,\n  MessageType,\n  Of,\n  Shared,\n  Void,\n} from \"silentium\";\nimport { Render } from \"silentium-morphdom\";\nimport { Element } from \"silentium-web-api\";\nimport { ClassName } from \"./ClassName\";\nimport { Id } from \"./Id\";\n\nexport function Mount(\n  $base: MessageType<unknown>,\n  tag: string = \"div\",\n  defaultValue = \"\",\n) {\n  let $baseString = Applied($base, (v) =>\n    typeof v === \"string\" ? v : String(v),\n  );\n  return Message<string>((resolve, reject) => {\n    const dc = DestroyContainer();\n    const $id = Shared(Id(Of(\"mount-point\")));\n    Applied($id, (id) => `<${tag} class=\"${id}\"></${tag}>`).then(resolve);\n    const $el = Element(ClassName($id)).catch(reject);\n    if (defaultValue) {\n      $baseString = Any($baseString, defaultValue);\n    }\n    const $r = Render($el, $baseString).catch(reject).then(Void());\n    dc.add($el);\n    dc.add($r);\n    return () => {\n      dc.destroy();\n    };\n  });\n}\n","import { Message, MessageType, Of, Shared, Void } from \"silentium\";\nimport { Render } from \"silentium-morphdom\";\nimport { Element } from \"silentium-web-api\";\nimport { ClassName } from \"./ClassName\";\nimport { Id } from \"./Id\";\n\n/**\n * Returns a unique class id that needs to be used\n * in the template for mounting $base.\n * This technique allows decoupling\n * the rendering of the main template from the rendering\n * of some nested part.\n */\nexport function MountPoint($base: MessageType<string>) {\n  return Message<string>((transport) => {\n    const $id = Shared(Id(Of(\"mount-point\")));\n    $id.then(transport);\n    const $el = Element(ClassName($id));\n    Render($el, $base).then(Void());\n  });\n}\n","import {\n  All,\n  Applied,\n  FromEvent,\n  Message,\n  MessageSourceType,\n  MessageType,\n  Shared,\n} from \"silentium\";\nimport { Template } from \"silentium-components\";\nimport { Element } from \"silentium-web-api\";\nimport { html } from \"./html\";\nimport { Id } from \"./Id\";\nimport { ClassName } from \"./ClassName\";\n\nexport function Select(\n  $value: MessageSourceType<string>,\n  $items: MessageType<unknown[]>,\n) {\n  return Template(\n    (t) => html`\n      <select\n        class=\"${t.escaped(\n          SelectId($value),\n        )} border-1 border-gray-300 bg-white p-2 rounded-sm w-full\"\n      >\n        <option value=\"\"></option>\n        ${t.raw(\n          Applied($items, (s) =>\n            s\n              .map(\n                (i: any) => html`<option value=\"${i._id}\">${i.title}</option>`,\n              )\n              .join(\"\"),\n          ),\n        )}\n      </select>\n    `,\n  );\n}\n\nexport function SelectId($value: MessageSourceType<string>) {\n  return Message<string>((resolve, reject) => {\n    const $id = Shared(Id());\n    $id.then(resolve);\n\n    const $el = Shared(Element<HTMLInputElement>(ClassName($id)));\n\n    All($el, $value).then(([el, value]) => {\n      if (el) {\n        el.value = value;\n      }\n    });\n\n    const event = FromEvent<Event>(\n      $el,\n      \"change\",\n      \"addEventListener\",\n      \"removeEventListener\",\n    )\n      .catch(reject)\n      .then((e) => {\n        $value.use((e.target as HTMLInputElement).value);\n      });\n\n    return () => {\n      event.destroy();\n    };\n  });\n}\n","import { Actual, MaybeMessage, MessageSourceType } from \"silentium\";\nimport { Template } from \"silentium-components\";\nimport { html } from \"./html\";\nimport { InputId } from \"./Input\";\n\n/**\n * Textarea UI element\n */\nexport function Textarea(\n  $value: MessageSourceType<string>,\n  _class: MaybeMessage<string> = \"\",\n) {\n  const class$ = Actual(_class);\n  return Template(\n    (t) => html`\n      <textarea\n        rows=\"3\"\n        class=\"${t.escaped(InputId($value))} ${t.escaped(class$)}\"\n      ></textarea>\n    `,\n  );\n}\n"],"names":["ClassName","s","Applied","Clicked","$class","Message","resolve","className","handler","event","target","classList","contains","closest","then","newClassName","document","body","addEventListener","removeEventListener","html","strings","values","result","i","length","Id","baseSrc","Of","All","v4","v","join","Button","$label","click","$attributes","value","$id","Shared","clicked","e","preventDefault","use","Connected","Template","t","escaped","Actual","Checkbox","label","$value","CheckedId","reject","$el","Element","el","checked","FromEvent","catch","destroy","KeyPressed","Input","InputId","transport","String","pressed","Task","Link","$linkUrl","$text","$url","Context","url","Primitive","primitive","raw","LinkExternal","Mount","$base","tag","defaultValue","$baseString","dc","DestroyContainer","id","Any","$r","Render","Void","add","MountPoint","Select","$items","SelectId","map","_id","title","Textarea","_class","class$"],"mappings":"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"}